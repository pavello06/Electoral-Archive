Unit SearchUnit;

Interface

Uses
    Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants,
    System.Classes, Vcl.Graphics,
    Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls,
    NameComponentUnit, CandidateListUnit, PartyUnit;

Type
    TSearchForm = Class(TForm)
        TitleLabel: TLabel;
        SearchEdit: TEdit;
        SearchButton: TButton;

        Function FormHelp(Command: Word; Data: NativeInt; Var CallHelp: Boolean): Boolean;

        Procedure SearchEditChange(Sender: TObject);
        Procedure SearchEditContextPopup(Sender: TObject; MousePos: TPoint; Var Handled: Boolean);
        Procedure SearchEditKeyDown(Sender: TObject; Var Key: Word; Shift: TShiftState);
        Procedure SearchEditKeyPress(Sender: TObject; Var Key: Char);
        Procedure SearchEditKeyUp(Sender: TObject; Var Key: Word; Shift: TShiftState);

        Procedure SearchButtonClick(Sender: TObject);

    Private
        { Private declarations }
    Public
        { Public declarations }
    End;

Var
    SearchForm: TSearchForm;
    PartyName: TPartyName;

Implementation

{$R *.dfm}

Function TSearchForm.FormHelp(Command: Word; Data: NativeInt; Var CallHelp: Boolean): Boolean;
Begin
    CallHelp := False;
    FormHelp := False;
End;


Procedure TSearchForm.SearchEditChange(Sender: TObject);
Begin
    PartyName := TPartyName(Trim(SearchEdit.Text));
    SearchButton.Enabled := Trim(SearchEdit.Text) <> '';
End;

Procedure TSearchForm.SearchEditContextPopup(Sender: TObject; MousePos: TPoint; Var Handled: Boolean);
Begin
    NameComponentContextPopup(SearchEdit.Text, SearchEdit.SelStart, SearchEdit.SelLength, MAX_PARTY_NAME_LENGTH, Handled);
End;

Procedure TSearchForm.SearchEditKeyDown(Sender: TObject; Var Key: Word; Shift: TShiftState);
Begin
    NameComponentKeyDown(SearchEdit.Text, SearchEdit.SelStart, SearchEdit.SelLength, MAX_PARTY_NAME_LENGTH, Key, Shift);
End;

Procedure TSearchForm.SearchEditKeyPress(Sender: TObject; Var Key: Char);
Begin
    If Key = ENTER Then
        SearchButtonClick(SearchButton)
    Else
        NameComponentKeyPress(SearchEdit.Text, SearchEdit.SelStart, SearchEdit.SelLength, MAX_PARTY_NAME_LENGTH, Key);
End;

Procedure TSearchForm.SearchEditKeyUp(Sender: TObject; Var Key: Word; Shift: TShiftState);
Begin
    NameComponentKeyUp();
End;


Procedure TSearchForm.SearchButtonClick(Sender: TObject);
Begin
    PartyForm := TPartyForm.Create(Self);
    PartyForm.Icon := SearchForm.Icon;
    PartyForm.Caption := 'Партия ' + String(PartyName);
    PartyForm.ShowModal;
End;

End.
